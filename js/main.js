// Embedded Translations (Consolidated for file:// protocol compatibility)
const translations = {
    es: {
        nav_home: "Inicio",
        nav_services: "Servicios",
        nav_team: "El Equipo",
        nav_contact: "Contáctanos",

        // Navigation Dropdown
        nav_serv_boutique: "Servicios Boutique",
        nav_serv_investors: "Para Inversores",
        nav_serv_management: "Gestión de Activos",

        hero_headline: "",
        hero_subheadline: "El primer property shopper que encuentra tu hogar y lo transforma contigo, de principio a fin: selección del activo, arquitectura de primer nivel, reforma y diseño integral, y un acompañamiento legal y estratégico que asegura siempre las mejores condiciones",
        hero_subheadline_mobile: "El primer property shopper que encuentra tu hogar y lo transforma contigo, de principio a fin: selección del activo, arquitectura de primer nivel, reforma y diseño integral",
        hero_cta_primary: "Contáctanos ahora",
        hero_cta_secondary: "Nuestros servicios",

        services_title: "Servicios que ofrece Quiti Properties",

        // Boutique Services
        serv_boutique_title: "Servicios Boutique",
        serv_boutique_p1_title: "Entendimiento del cliente:",
        serv_boutique_p1_desc: "Identificamos rápido tus objetivos, presupuesto y preferencias para ajustar todo el proceso a ti",
        serv_boutique_p2_title: "Búsqueda de vivienda:",
        serv_boutique_p2_desc: "Te enviamos una selección ultra-curada. Nuestra experiencia, red de agencias y tecnología nos permite encontrar las mejores opciones on-market y off-market",
        serv_boutique_p3_title: "Visitas eficientes:",
        serv_boutique_p3_desc: "Hacemos las visitas por ti y te las mostramos por vídeo; o te acompañamos en persona. Simplificamos todo para que sea cómodo y rápido",
        serv_boutique_p4_title: "Negociación + Due Diligence:",
        serv_boutique_p4_desc: "Negociamos el mejor precio y condiciones, apoyados por una due diligence completa. Conocemos cada barrio y sabemos a qué precio debe cerrarse cada vivienda en Madrid",
        serv_boutique_tasacion_title: "Tasación:",
        serv_boutique_tasacion_desc: "Nuestra relación con una de las tasadoras españolas de referencia nos permite maximizar el resultado de cara a obtener la mejor financiación",
        serv_boutique_p5_title: "Financiación:",
        serv_boutique_p5_desc: "Te conectamos con bancos colaboradores para conseguir la hipoteca que mejor encaje contigo y en las mejores condiciones",
        serv_boutique_p6_title: "Contratos y cierre:",
        serv_boutique_p6_desc: "Nuestros abogados revisan y negocian toda la documentación legal y te acompañamos hasta la firma final",
        serv_boutique_p7_title: "Estudio de arquitectura e interiorismo (opcional):",
        serv_boutique_p7_desc: "Te gestionamos la reforma con partners de primer nivel: Gestión de la Declaración Responsable, estudio de arquitectura, constructora y estudio de interiorismo",

        // Investors Services
        serv_investors_title: "Servicios para inversores / extranjeros",
        serv_inv_p1: "Optimizamos la estructuración fiscal de la inversión",
        serv_inv_p2: "Te ayudamos a abrir tu cuenta bancaria en España",
        serv_inv_p3: "Gestionamos la creación de tu sociedad en España",
        serv_inv_p4: "Cualquier apoyo legal o fiscal que necesites",

        // Management Services
        serv_management_title: "Gestión de alquileres / Asset management",
        serv_man_p1: "Sin conflictos de interés: Solo trabajamos para ti",
        serv_man_p2: "Gestión integral y transparente del alquiler",
        serv_man_p3: "Seleccionamos inquilinos de alta calidad",
        serv_man_p4: "Sin mes de agencia: Solo cobramos un % mensual fijo, que incluye la gestión completa del alquiler así como la gestión de las posibles incidencias",

        why_title: "¿Por qué elegirnos?",
        why_1: "Atención boutique, solo trabajamos por y para ti",
        why_2: "Conocimiento profundo de barrios en Madrid",
        why_3: "Equipo multidisciplinar para cubrir todas las necesidades de nuestros clientes",
        why_4: "Servicios legales integrales",

        team_title: "Sobre nosotros",
        team_subtitle: "Expertos unidos por la pasión inmobiliaria y el diseño.",
        team_role_1: "Director General",
        team_role_2: "Responsable búsqueda vivienda",
        team_role_3: "Abogado jurídico",
        team_role_4: "Abogado fiscalista",
        team_role_5: "Estudio de arquitectura e interiorismo",
        team_role_6: "Constructora",
        team_desc_1: "Quiti Properties nace de la pasión por ayudar a personas, familias e inversores a encontrar su hogar ideal. Cansados de la opacidad del sector, somos mucho más que un personal shopper: somos tu compañero de viaje, con un servicio boutique pensado para que la compra de tu vivienda sea una experiencia única y memorable.",
        team_desc_2: "Nuestra experiencia inmobiliaria en Madrid nos permite ofrecer un servicio end-to-end totalmente transparente, diseñado para que cada paso —comprar, reformar, alquilar, gestionar tu patrimonio o acompañarte en cualquier necesidad legal y fiscal— sea fluido y sin fricciones.",
        team_desc_3: "Contamos con un equipo proactivo, con conocimiento local y visión global, que entiende las necesidades de clientes nacionales e internacionales y convierte cada proyecto en algo verdaderamente especial.",

        contact_title: "Contáctanos",
        contact_name_placeholder: "Nombre",
        contact_email_placeholder: "Email",
        contact_phone_placeholder: "Teléfono",
        contact_message_placeholder: "Mensaje",
        contact_submit: "Envíame esta información",

        legal_text: "© 2025 Quiti Properties. Todos los derechos reservados. Política de Privacidad."
    },
    en: {
        nav_home: "Home",
        nav_services: "Services",
        nav_team: "The Team",
        nav_contact: "Contact Us",

        // Navigation Dropdown
        nav_serv_boutique: "Boutique Services",
        nav_serv_investors: "For Investors",
        nav_serv_management: "Asset Management",

        hero_headline: "",
        hero_subheadline: "The first property shopper to find your home and transform it with you, from start to finish: curated asset selection, top-tier architecture, full renovation and design, and strategic legal guidance to consistently secure the best terms",
        hero_subheadline_mobile: "The first property shopper to find your home and transform it with you, from start to finish: curated asset selection, top-tier architecture, full renovation and design",
        hero_cta_primary: "Contact us now",
        hero_cta_secondary: "Our services",

        services_title: "Services offered by Quiti Properties",

        // Boutique Services
        serv_boutique_title: "Boutique Services",
        serv_boutique_p1_title: "Client Understanding:",
        serv_boutique_p1_desc: "We quickly identify your goals, budget, and preferences to tailor the entire process to you",
        serv_boutique_p2_title: "Property Search:",
        serv_boutique_p2_desc: "We send you an ultra-curated selection. Our experience, agency network, and technology allow us to find the best on-market and off-market options",
        serv_boutique_p3_title: "Efficient Visits:",
        serv_boutique_p3_desc: "We do the visits for you and show them via video; or we accompany you in person. We simplify everything to make it comfortable and fast",
        serv_boutique_p4_title: "Negotiation + Due Diligence:",
        serv_boutique_p4_desc: "We negotiate the best price and terms, supported by complete due diligence. We know every neighborhood and the closing price for every home in Madrid",
        serv_boutique_tasacion_title: "Appraisal:",
        serv_boutique_tasacion_desc: "Our relationship with one of the leading Spanish appraisal companies allows us to maximize the result in order to obtain the best financing",
        serv_boutique_p5_title: "Financing:",
        serv_boutique_p5_desc: "We connect you with partner banks to get the mortgage that best fits you and at the best conditions",
        serv_boutique_p6_title: "Contracts and Closing:",
        serv_boutique_p6_desc: "Our lawyers review and negotiate all legal documentation and we accompany you until the final signature",
        serv_boutique_p7_title: "Architecture & Interior Design Studio (Optional):",
        serv_boutique_p7_desc: "We manage the renovation with top-tier partners: Management of Responsible Declaration, prestigious architecture studio, top-level construction company, and interior design studio",

        // Investors Services
        serv_investors_title: "Additional Services for Investors / Foreigners",
        serv_inv_p1: "We optimize the tax structuring of the investment",
        serv_inv_p2: "We help you open your bank account in Spain",
        serv_inv_p3: "We manage the creation of your company in Spain",
        serv_inv_p4: "Any legal or tax support you need",

        // Management Services
        serv_management_title: "Rental Management / Asset Management",
        serv_man_p1: "No conflicts of interest: We only work for you",
        serv_man_p2: "Comprehensive and transparent rental management",
        serv_man_p3: "We select high-quality tenants",
        serv_man_p4: "No agency fee: We only charge a fixed monthly %, which includes full rental management as well as incident management",

        why_title: "Why Choose Us?",
        why_1: "Boutique attention, working exclusively for you",
        why_2: "Deep knowledge of Madrid neighborhoods",
        why_3: "Multidisciplinary team to cover every need",
        why_4: "Comprehensive legal services",

        team_title: "The Team",
        team_subtitle: "Experts united by passion for real estate and design.",
        team_role_1: "General Manager",
        team_role_2: "Head of Property Search",
        team_role_3: "Legal Counsel",
        team_role_4: "Tax Lawyer",
        team_role_5: "Architecture & Interior Design Studio",
        team_role_6: "Construction Company",
        team_desc_1: "Quiti Properties was born from the passion to help people, families, and investors find their ideal home. Tired of the sector's opacity, we are much more than a personal shopper: we are your travel companion, with a boutique service designed to make buying your home a unique and memorable experience.",
        team_desc_2: "Our real estate experience in Madrid allows us to offer a totally transparent end-to-end service, designed so that every step —buying, renovating, renting, managing your assets, or accompanying you in any legal and tax need— is fluid and frictionless.",
        team_desc_3: "We have a proactive team, with local knowledge and global vision, that understands the needs of national and international clients and turns every project into something truly special.",

        contact_title: "Contact Us",
        contact_name_placeholder: "Name",
        contact_email_placeholder: "Email",
        contact_phone_placeholder: "Phone",
        contact_message_placeholder: "Message",
        contact_submit: "Send me this info",

        legal_text: "© 2025 Quiti Properties. All rights reserved. Privacy Policy."
    }
};

document.addEventListener('DOMContentLoaded', () => {
    // --- Language Switcher ---
    const langBtns = document.querySelectorAll('.lang-btn');

    // Set initial language based on browser or default to 'es'
    let currentLang = 'es';

    function updateContent(lang) {
        document.documentElement.lang = lang;

        // Update basic text elements
        const elements = document.querySelectorAll('[data-i18n]');
        const isMobile = window.innerWidth <= 768;

        elements.forEach(el => {
            const key = el.getAttribute('data-i18n');
            const mobileKey = `${key}_mobile`;

            if (isMobile && translations[lang][mobileKey]) {
                el.innerText = translations[lang][mobileKey];
            } else if (translations[lang][key]) {
                el.innerText = translations[lang][key];
            }
        });

        // Update placeholder attributes
        const placeholders = document.querySelectorAll('[data-i18n-placeholder]');
        placeholders.forEach(el => {
            const key = el.getAttribute('data-i18n-placeholder');
            if (translations[lang][key]) {
                el.placeholder = translations[lang][key];
            }
        });

        // Update active button state
        langBtns.forEach(btn => {
            if (btn.dataset.lang === lang) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });

        currentLang = lang;
    }

    langBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const lang = btn.dataset.lang;
            updateContent(lang);
        });
    });

    // Initialize content
    updateContent(currentLang);

    // Update content on resize to handle mobile/desktop text swaps
    let resizeTimer;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
            updateContent(currentLang);
        }, 250);
    });


    // --- Mobile Menu Toggle ---
    const navToggle = document.getElementById('navToggle');
    const navMenu = document.getElementById('navMenu');

    if (navToggle && navMenu) {
        const navbar = document.querySelector('.navbar');
        const logo = document.querySelector('.nav-logo');

        navToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
            navbar.classList.toggle('menu-active');

            // Toggle icon from bars to times
            const icon = navToggle.querySelector('i');
            if (navMenu.classList.contains('active')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
                if (logo) logo.src = 'assets/images/logonav.png';
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
                if (window.scrollY <= 50) {
                    if (logo) logo.src = 'assets/images/logoblanco.png';
                }
            }
        });

        // Close menu when clicking a link
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => {
                navMenu.classList.remove('active');
                navbar.classList.remove('menu-active');
                const icon = navToggle.querySelector('i');
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
                if (window.scrollY <= 50) {
                    if (logo) logo.src = 'assets/images/logoblanco.png';
                }
            });
        });
    }

    // Initialize AOS
    if (typeof AOS !== 'undefined') {
        setTimeout(() => {
            AOS.init();
        }, 100); // Small delay to ensure DOM is ready
    } else {
        console.warn('AOS library not loaded');
        // Fallback: make elements visible if AOS fails
        const aosElements = document.querySelectorAll('[data-aos]');
        aosElements.forEach(el => {
            el.style.opacity = '1';
            el.style.transform = 'none';
        });
    }

    // --- Navbar Scroll Effect ---
    const navbar = document.querySelector('.navbar');

    function handleScroll() {
        const logo = document.querySelector('.nav-logo');
        if (window.scrollY > 50) {
            navbar.classList.add('scrolled');
            if (logo) logo.src = 'assets/images/logonav.png';
        } else {
            navbar.classList.remove('scrolled');
            if (logo) logo.src = 'assets/images/logoblanco.png';
        }
    }

    window.addEventListener('scroll', handleScroll);
    // Trigger once on load in case page is refreshed halfway down
    handleScroll();
});
