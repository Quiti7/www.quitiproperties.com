// Embedded Translations (Consolidated for file:// protocol compatibility)
const translations = {
    es: {
        nav_home: "Inicio",
        nav_services: "Servicios",
        nav_team: "El Equipo",
        nav_contact: "Contáctanos",

        // Navigation Dropdown
        nav_serv_boutique: "Property shopper integral",
        nav_serv_investors: "Para Inversores",
        nav_serv_management: "Gestión de Activos",

        // Boutique Sub-page
        boutique_hero_title: "Property shopper integral",
        boutique_hero_subtitle: "Experiencia integral y personalizada para encontrar tu hogar ideal.",
        boutique_hero_cta_more: "Descubre más",
        boutique_hero_cta_info: "Solicitar Información",
        boutique_intro: "Nuestros servicios están diseñados para acompañarte en cada paso de la compra de tu vivienda en Madrid. Ofrecemos un asesoramiento 360º que va más allá de la simple intermediación.",

        // Investors Sub-page
        investors_hero_title: "Inversores y Extranjeros",
        investors_hero_subtitle: "Soluciones integrales para optimizar tu inversión y aterrizaje en España.",
        investors_hero_cta_view: "Ver Servicios",
        investors_hero_cta_contact: "Contáctanos",
        investors_intro: "Facilitamos tu llegada e inversión en Madrid. Nos encargamos de todos los trámites burocráticos y legales para que tú solo te preocupes de disfrutar de tu inversión, con la seguridad de estar en manos expertas.",
        investors_f1_title: "Optimización Fiscal",
        investors_f1_desc: "Analizamos tu situación personal y patrimonial para optimizar la estructuración fiscal de tu inversión inmobiliaria en España. Diseñamos la estrategia más eficiente para asegurar el cumplimiento normativo y maximizar tu rentabilidad neta.",
        investors_f2_title: "Apertura de Cuenta Bancaria",
        investors_f2_desc: "Te ayudamos a abrir tu cuenta bancaria en España de forma ágil, conectándote con entidades de primer nivel que entienden las necesidades de inversores internacionales, facilitando la operativa de compra y gestión posterior.",
        investors_f3_title: "Creación de Sociedad",
        investors_f3_desc: "Si tu perfil de inversión lo requiere, gestionamos la constitución de tu sociedad en España (SL, patrimonial, etc.) encargándonos de todos los trámites registrales, notariales y fiscales para que puedas operar desde el primer día.",
        investors_f4_title: "Apoyo Legal y Golden Visa",
        investors_f4_desc: "Brindamos soporte jurídico integral durante tu estancia o proceso de inversión. Ofrecemos asesoramiento completo para la obtención de la Golden Visa si eres elegible, gestionando todo el expediente administrativo.",

        // Management Sub-page
        management_hero_title: "Gestión de Alquileres",
        management_hero_subtitle: "Asset Management integral para tu tranquilidad y rentabilidad.",
        management_hero_cta_how: "Cómo funciona",
        management_hero_cta_start: "Empieza a rentabilizar",
        management_intro: "Nos encargamos de todo para que tu inversión sea verdaderamente pasiva. Desde la selección del inquilino hasta el mantenimiento diario, gestionamos tu activo como si fuera nuestro.",
        management_f1_title: "Sin conflictos de interés",
        management_f1_desc: "Solo trabajamos para ti, el propietario. A diferencia de otras agencias, nuestros intereses están 100% alineados con los tuyos para maximizar el valor de tu activo a largo plazo, no una comisión rápida.",
        management_f2_title: "Gestión integral y transparente",
        management_f2_desc: "Nos ocupamos de los cobros, reparaciones, incidencias y relación diaria con el inquilino. Tú mantienes visibilidad total a través de informes transparentes, pero sin los dolores de cabeza de la gestión.",
        management_f3_title: "Seleccionamos inquilinos de alta calidad",
        management_f3_desc: "Realizamos un filtrado exhaustivo (scoring financiero, referencias) para encontrar inquilinos solventes y fiables. Tu tranquilidad y el cuidado de tu inmueble dependen de quién vive en tu casa.",
        management_f4_title: "Rentabilidad Maximizada",
        management_f4_desc: "Revisamos periódicamente las rentas conforme al mercado y optimizamos los costes operativos para asegurar que estás obteniendo el máximo retorno posible de tu inversión en todo momento.",
        management_highlight_title: "Sin mes de agencia",
        management_highlight_desc: "Solo cobramos un % mensual fijo, que incluye la gestión completa del alquiler así como la gestión de las posibles incidencias. Sin sorpresas ni costes ocultos.",
        management_highlight_cta: "Contactar Ahora",

        hero_headline: "",
        hero_subheadline: "El primer property shopper que encuentra tu hogar y lo transforma contigo, de principio a fin: selección del activo, arquitectura de primer nivel, reforma y diseño integral, y un acompañamiento legal y estratégico que asegura siempre las mejores condiciones",
        hero_subheadline_mobile: "El primer property shopper que encuentra tu hogar y lo transforma contigo, de principio a fin: selección del activo, arquitectura de primer nivel, reforma y diseño integral",
        hero_cta_primary: "Contáctanos ahora",
        hero_cta_secondary: "Nuestros servicios",

        services_title: "Servicios que ofrece Quiti Properties",

        // Boutique Services
        serv_boutique_title: "Property shopper integral",
        serv_boutique_p1_title: "Entendimiento del cliente:",
        serv_boutique_p1_desc: "Identificamos rápido tus objetivos, presupuesto y preferencias para ajustar todo el proceso a ti",
        serv_boutique_p2_title: "Búsqueda de vivienda:",
        serv_boutique_p2_desc: "Te enviamos una selección ultra-curada. Nuestra experiencia, red de agencias y tecnología nos permite encontrar las mejores opciones on-market y off-market",
        serv_boutique_p3_title: "Visitas eficientes:",
        serv_boutique_p3_desc: "Hacemos las visitas por ti y te las mostramos por vídeo; o te acompañamos en persona. Simplificamos todo para que sea cómodo y rápido",
        serv_boutique_p4_title: "Negociación + Due Diligence:",
        serv_boutique_p4_desc: "Negociamos el mejor precio y condiciones, apoyados por una due diligence completa. Conocemos cada barrio y sabemos a qué precio debe cerrarse cada vivienda en Madrid",
        serv_boutique_tasacion_title: "Tasación:",
        serv_boutique_tasacion_desc: "Maximizar resultado para financiación.",
        serv_boutique_p5_title: "Financiación:",
        serv_boutique_p5_desc: "Nuestra relación con dos de las principales entidades financieras especializadas en tasación nos permite conectar a nuestros clientes con las mejores alternativas disponibles en el mercado",
        serv_boutique_p6_title: "Contratos y cierre:",
        serv_boutique_p6_desc: "Nuestros abogados revisan y negocian toda la documentación legal y te acompañamos hasta la firma final",
        serv_boutique_p7_title: "Estudio de arquitectura e interiorismo:",
        serv_boutique_p7_desc: "Apoyados en partnerships estratégicos con estudios de arquitectura e interiorismo de primer nivel y constructoras de referencia, en Quiti Properties lideramos la reforma de tu vivienda, asegurando máxima calidad y un proceso eficiente, transparente y exitoso",

        // Investors Services
        serv_investors_title: "Servicios para inversores / extranjeros",
        serv_inv_p1: "Optimizamos la estructuración fiscal de la inversión",
        serv_inv_p2: "Te ayudamos a abrir tu cuenta bancaria en España",
        serv_inv_p3: "Gestionamos la creación de tu sociedad en España",
        serv_inv_p4: "Cualquier apoyo legal o fiscal que necesites",

        // Management Services
        serv_management_title: "Gestión de alquileres / Asset management",
        serv_man_p1: "Sin conflictos de interés: Solo trabajamos para ti",
        serv_man_p2: "Gestión integral y transparente del alquiler",
        serv_man_p3: "Seleccionamos inquilinos de alta calidad",
        serv_man_p4: "Sin mes de agencia: Solo cobramos un % mensual fijo, que incluye la gestión completa del alquiler así como la gestión de las posibles incidencias",

        why_title: "¿Por qué elegirnos?",
        why_1: "Atención personalizada, solo trabajamos por y para ti",
        why_2: "Conocimiento profundo de barrios en Madrid",
        why_3: "Equipo multidisciplinar para cubrir todas las necesidades de nuestros clientes",
        why_4: "Servicios legales integrales",
        why_summary: "En Quiti Properties te acompañamos de principio a fin: desde la búsqueda de la vivienda hasta la reforma integral con nuestros estudios de arquitectura partners y la entrega de llaves. Un proceso sencillo, de máxima calidad y totalmente alineado con las necesidades de cada cliente.",

        team_title: "Sobre nosotros",
        team_subtitle: "Expertos unidos por la pasión inmobiliaria y el diseño.",
        team_role_1: "Director General",
        team_role_2: "Responsable búsqueda vivienda",
        team_role_3: "Abogado jurídico",
        team_role_4: "Abogado fiscalista",
        team_role_5: "Estudio de arquitectura e interiorismo",
        team_role_6: "Constructora",
        team_desc_1: "Quiti Properties nace de la pasión por ayudar a personas, familias e inversores a encontrar su hogar ideal. Cansados de la opacidad del sector, somos mucho más que un personal shopper: somos tu compañero de viaje, con un servicio integral pensado para que la compra de tu vivienda sea una experiencia única y memorable.",
        team_desc_2: "Nuestra experiencia inmobiliaria en Madrid nos permite ofrecer un servicio end-to-end totalmente transparente, diseñado para que cada paso —comprar, reformar, alquilar, gestionar tu patrimonio o acompañarte en cualquier necesidad legal y fiscal— sea fluido y sin fricciones.",
        team_desc_3: "Contamos con un equipo proactivo, con conocimiento local y visión global, que entiende las necesidades de clientes nacionales e internacionales y convierte cada proyecto en algo verdaderamente especial.",

        contact_title: "Contáctanos",
        contact_name_label: "Nombre",
        contact_name_placeholder: "Tu nombre completo",
        contact_email_label: "Email",
        contact_email_placeholder: "tu@email.com",
        contact_phone_label: "Teléfono",
        contact_phone_placeholder: "+34 ...",
        contact_message_label: "Mensaje",
        contact_message_placeholder: "¿En qué podemos ayudarte?",
        contact_submit: "Envíame esta información",
        contact_headline: "Hablemos de tu futuro hogar",
        contact_address: "Núñez de Balboa 47. Madrid, España",

        legal_text: "© 2025 Quiti Properties. Todos los derechos reservados. Política de Privacidad."
    },
    en: {
        nav_home: "Home",
        nav_services: "Services",
        nav_team: "The Team",
        nav_contact: "Contact Us",

        // Navigation Dropdown
        nav_serv_boutique: "Property shopper integral",
        nav_serv_investors: "For Investors",
        nav_serv_management: "Asset Management",

        hero_headline: "",
        hero_subheadline: "The first property shopper to find your home and transform it with you, from start to finish: curated asset selection, top-tier architecture, full renovation and design, and strategic legal guidance to consistently secure the best terms",
        hero_subheadline_mobile: "The first property shopper to find your home and transform it with you, from start to finish: curated asset selection, top-tier architecture, full renovation and design",
        hero_cta_primary: "Contact us now",
        hero_cta_secondary: "Our services",

        services_title: "Services offered by Quiti Properties",

        // Boutique Services (Home page cards)
        serv_boutique_title: "Property shopper integral",
        serv_boutique_subtitle: "Comprehensive and personalized experience.",
        serv_boutique_p1_title: "Client Understanding:",
        serv_boutique_p1_desc: "We quickly identify your goals, budget, and preferences to tailor the entire process to you",
        serv_boutique_p2_title: "Property Search:",
        serv_boutique_p2_desc: "We send you an ultra-curated selection. Our experience, agency network, and technology allow us to find the best on-market and off-market options",
        serv_boutique_p3_title: "Efficient Visits:",
        serv_boutique_p3_desc: "We do the visits for you and show them via video; or we accompany you in person. We simplify everything to make it comfortable and fast",
        serv_boutique_p4_title: "Negotiation + Due Diligence:",
        serv_boutique_p4_desc: "We negotiate the best price and terms, supported by complete due diligence. We know every neighborhood and the closing price for every home in Madrid",
        serv_boutique_tasacion_title: "Appraisal:",
        serv_boutique_tasacion_desc: "Maximize result for financing.",
        serv_boutique_p5_title: "Financing:",
        serv_boutique_p5_desc: "Our relationship with two of the leading financial institutions specialized in valuation allows us to connect our clients with the best alternatives available in the market",
        serv_boutique_p6_title: "Contracts and Closing:",
        serv_boutique_p6_desc: "Our lawyers review and negotiate all legal documentation and we accompany you until the final signature",
        serv_boutique_p7_title: "Architecture & Interior Design Studio:",
        serv_boutique_p7_desc: "Backed by strategic partnerships with top-tier architecture and interior design studios, as well as leading construction firms, Quiti Properties leads the renovation of your home, ensuring the highest quality and a process that is efficient, transparent, and successful",

        // Boutique Sub-page
        boutique_hero_title: "Property shopper integral",
        boutique_hero_subtitle: "Comprehensive and personalized experience to find your ideal home.",
        boutique_hero_cta_more: "Discover more",
        boutique_hero_cta_info: "Request Information",
        boutique_intro: "Our services are designed to accompany you in every step of buying your home in Madrid. We offer a 360º advice that goes beyond simple intermediation.",

        // Investors Services
        serv_investors_title: "Additional Services for Investors / Foreigners",
        serv_inv_p1: "We optimize the tax structuring of the investment",
        serv_inv_p2: "We help you open your bank account in Spain",
        serv_inv_p3: "We manage the creation of your company in Spain",
        serv_inv_p4: "Any legal or tax support you need",

        // Investors Sub-page
        investors_hero_title: "Investors and Foreigners",
        investors_hero_subtitle: "Comprehensive solutions to optimize your investment and landing in Spain.",
        investors_hero_cta_view: "View Services",
        investors_hero_cta_contact: "Contact Us",
        investors_intro: "We facilitate your arrival and investment in Madrid. We take care of all the bureaucratic and legal procedures so that you only worry about enjoying your investment, with the security of being in expert hands.",
        investors_f1_title: "Tax Optimization",
        investors_f1_desc: "We analyze your personal and wealth situation to optimize the tax structuring of your real estate investment in Spain. We design the most efficient strategy to ensure regulatory compliance and maximize your net profitability.",
        investors_f2_title: "Bank Account Opening",
        investors_f2_desc: "We help you open your bank account in Spain in an agile way, connecting you with top-tier entities that understand the needs of international investors, facilitating the operation of purchase and subsequent management.",
        investors_f3_title: "Company Creation",
        investors_f3_desc: "If your investment profile requires it, we manage the constitution of your company in Spain (SL, patrimonial, etc.) by taking care of all the registration, notary and tax procedures so that you can operate from the first day.",
        investors_f4_title: "Legal Support and Golden Visa",
        investors_f4_desc: "We provide comprehensive legal support during your stay or investment process. We offer complete advice for obtaining the Golden Visa if you are eligible, managing the entire administrative file.",

        // Management Services
        serv_management_title: "Rental Management / Asset Management",
        serv_man_p1: "No conflicts of interest: We only work for you",
        serv_man_p2: "Comprehensive and transparent rental management",
        serv_man_p3: "We select high-quality tenants",
        serv_man_p4: "No agency fee: We only charge a fixed monthly %, which includes full rental management as well as incident management",

        // Management Sub-page
        management_hero_title: "Rental Management",
        management_hero_subtitle: "Comprehensive Asset Management for your peace of mind and profitability.",
        management_hero_cta_how: "How it works",
        management_hero_cta_start: "Start profiting",
        management_intro: "We take care of everything so that your investment is truly passive. From tenant selection to daily maintenance, we manage your asset as if it were ours.",
        management_f1_title: "No conflicts of interest",
        management_f1_desc: "We only work for you, the owner. Unlike other agencies, our interests are 100% aligned with yours to maximize the value of your asset in the long term, not a quick commission.",
        management_f2_title: "Comprehensive and transparent management",
        management_f2_desc: "We take care of collections, repairs, incidents and daily relationship with the tenant. You maintain full visibility through transparent reports, but without the management headaches.",
        management_f3_title: "We select high-quality tenants",
        management_f3_desc: "We perform exhaustive filtering (financial scoring, references) to find solvent and reliable tenants. Your peace of mind and the care of your property depend on who lives in your house.",
        management_f4_title: "Maximized Profitability",
        management_f4_desc: "We periodically review rents according to the market and optimize operating costs to ensure that you are obtaining the maximum possible return from your investment at all times.",
        management_highlight_title: "No agency fee",
        management_highlight_desc: "We only charge a fixed monthly %, which includes full rental management as well as management of potential incidents. No surprises or hidden costs.",
        management_highlight_cta: "Contact Now",

        why_title: "Why Choose Us?",
        why_1: "Personalized attention, working exclusively for you",
        why_2: "Deep knowledge of Madrid neighborhoods",
        why_3: "Multidisciplinary team to cover every need",
        why_4: "Comprehensive legal services",
        why_summary: "At Quiti Properties, we accompany you from start to finish: from searching for the property to the full renovation with our partner architecture studios and the key handover. A simple, high-quality process fully aligned with each client's needs.",

        team_title: "The Team",
        team_subtitle: "Experts united by passion for real estate and design.",
        team_role_1: "General Manager",
        team_role_2: "Head of Property Search",
        team_role_3: "Legal Counsel",
        team_role_4: "Tax Lawyer",
        team_role_5: "Architecture & Interior Design Studio",
        team_role_6: "Construction Company",
        team_desc_1: "Quiti Properties was born from the passion to help people, families, and investors find their ideal home. Tired of the sector's opacity, we are much more than a personal shopper: we are your travel companion, with an end-to-end service designed to make buying your home a unique and memorable experience.",
        team_desc_2: "Our real estate experience in Madrid allows us to offer a totally transparent end-to-end service, designed so that every step —buying, renovating, renting, managing your assets, or accompanying you in any legal and tax need— is fluid and frictionless.",
        team_desc_3: "We have a proactive team, with local knowledge and global vision, that understands the needs of national and international clients and turns every project into something truly special.",

        contact_title: "Contact Us",
        contact_name_label: "Name",
        contact_name_placeholder: "Your full name",
        contact_email_label: "Email",
        contact_email_placeholder: "your@email.com",
        contact_phone_label: "Phone",
        contact_phone_placeholder: "+34 ...",
        contact_message_label: "Message",
        contact_message_placeholder: "How can we help you?",
        contact_submit: "Send me this info",
        contact_headline: "Let's talk about your future home",
        contact_address: "Núñez de Balboa 47. Madrid, España",

        legal_text: "© 2025 Quiti Properties. All rights reserved. Privacy Policy."
    }
};

document.addEventListener('DOMContentLoaded', () => {
    // --- Language Switcher ---
    const langBtns = document.querySelectorAll('.lang-btn');

    // Set initial language based on browser or default to 'es'
    let currentLang = 'es';

    function updateContent(lang) {
        document.documentElement.lang = lang;

        // Update basic text elements
        const elements = document.querySelectorAll('[data-i18n]');
        const isMobile = window.innerWidth <= 768;

        elements.forEach(el => {
            const key = el.getAttribute('data-i18n');
            const mobileKey = `${key}_mobile`;

            if (isMobile && translations[lang][mobileKey]) {
                el.innerText = translations[lang][mobileKey];
            } else if (translations[lang][key]) {
                el.innerText = translations[lang][key];
            }
        });

        // Update placeholder attributes
        const placeholders = document.querySelectorAll('[data-i18n-placeholder]');
        placeholders.forEach(el => {
            const key = el.getAttribute('data-i18n-placeholder');
            if (translations[lang][key]) {
                el.placeholder = translations[lang][key];
            }
        });

        // Update active button state
        langBtns.forEach(btn => {
            if (btn.dataset.lang === lang) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });

        currentLang = lang;
    }

    langBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            const lang = btn.dataset.lang;
            updateContent(lang);
        });
    });

    // Initialize content
    updateContent(currentLang);

    // Update content on resize to handle mobile/desktop text swaps
    let resizeTimer;
    window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
            updateContent(currentLang);
        }, 250);
    });


    // --- Mobile Menu Toggle ---
    const navToggle = document.getElementById('navToggle');
    const navMenu = document.getElementById('navMenu');

    if (navToggle && navMenu) {
        const navbar = document.querySelector('.navbar');
        const logo = document.querySelector('.nav-logo');

        navToggle.addEventListener('click', () => {
            navMenu.classList.toggle('active');
            navbar.classList.toggle('menu-active');

            // Toggle icon from bars to times
            const icon = navToggle.querySelector('i');
            if (navMenu.classList.contains('active')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
                if (logo) logo.src = 'assets/images/logonav.png';
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
                if (window.scrollY <= 50) {
                    if (logo) logo.src = 'assets/images/logoblanco.png';
                }
            }
        });

        // Close menu when clicking a link
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => {
                navMenu.classList.remove('active');
                navbar.classList.remove('menu-active');
                const icon = navToggle.querySelector('i');
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
                if (window.scrollY <= 50) {
                    if (logo) logo.src = 'assets/images/logoblanco.png';
                }
            });
        });
    }

    // Initialize AOS
    if (typeof AOS !== 'undefined') {
        setTimeout(() => {
            AOS.init();
        }, 100); // Small delay to ensure DOM is ready
    } else {
        console.warn('AOS library not loaded');
        // Fallback: make elements visible if AOS fails
        const aosElements = document.querySelectorAll('[data-aos]');
        aosElements.forEach(el => {
            el.style.opacity = '1';
            el.style.transform = 'none';
        });
    }

    // --- Navbar Scroll Effect ---
    const navbar = document.querySelector('.navbar');

    function handleScroll() {
        const logo = document.querySelector('.nav-logo');
        if (window.scrollY > 50) {
            navbar.classList.add('scrolled');
            if (logo) logo.src = 'assets/images/logonav.png';
        } else {
            navbar.classList.remove('scrolled');
            if (logo) logo.src = 'assets/images/logoblanco.png';
        }
    }

    window.addEventListener('scroll', handleScroll);
    // Trigger once on load in case page is refreshed halfway down
    handleScroll();
});
